var f=f||{};f.a=f.a||{};window.CreJs=f;f.Creanvas=f.a;(function(){var b=f.s=f.s||{};b.t=function(e,c,a){var d=this;this.B=e;this.C=c;this.S=a||0;this.fb=function(a,b,c,e){a.lineWidth=5;a.strokeStyle=e;a.beginPath();a.moveTo(b,c);a.lineTo(b+100*d.B,c+100*d.C);a.stroke();a.lineWidth=1;a.strokeStyle="#000"};this.za=function(a){return{M:b.na(d,a.M),v:b.na(d,a.v),Ia:b.na(d,a.Ia)}}};Object.defineProperty(b.t.prototype,"x",{get:function(){return this.B},set:function(b){this.B=b}});Object.defineProperty(b.t.prototype,"y",{get:function(){return this.C},set:function(b){this.C=
b}});Object.defineProperty(b.t.prototype,"z",{get:function(){return this.S},set:function(b){this.S=b}});b.Ta=function(e,c,a,d){e=a-e;c=d-c;d=Math.sqrt(e*e+c*c);return{M:new b.t(e/d,c/d,0),v:new b.t(-c/d,e/d,0),Ia:new b.t(0,0,0)}};b.hb=function(b,c,a,d,k){b.lineWidth=5;b.strokeStyle=k;b.beginPath();b.moveTo(c,a);b.lineTo(c+100*d.M.B,a+100*d.M.C);b.moveTo(c,a);b.lineTo(c+50*d.v.B,a+50*d.v.C);b.stroke();b.lineWidth=1;b.strokeStyle="#000"};b.gb=function(b,c,a,d,k,l,n){b.lineWidth=5;b.strokeStyle=n;b.beginPath();
b.moveTo(c,a);b.lineTo(c+100*k*d.M.B,a+100*k*d.M.C);b.lineTo(c+100*k*d.M.B+100*l*d.v.B,a+100*k*d.M.C+100*l*d.v.C);b.stroke();b.lineWidth=1;b.strokeStyle="#000"};b.na=function(b,c){return b.B*c.B+b.C*c.C};b.fa=function(e,c){return new b.t(e.C*c.S-e.S*c.C,e.S*c.B-e.B*c.S,e.B*c.C-e.C*c.B)};f.Core=f.s;f.s.Vector=f.s.t})();f.a.Ja=function(b){function e(){return b.elements.filter(function(d){return d.Za})}function c(d,a,b){var c,m,e,h,r,g;c=b.eb;h=new f.s.t(b.x-d.i,b.y-d.j);r=f.s.fa(h,c.v).z;g=new f.s.t(b.x-a.i,b.y-a.j);b=f.s.fa(g,c.v).z;var q=f.s.fa(h,c.v),s=f.s.fa(g,c.v);m=new f.s.t(d.f.x,d.f.y);e=new f.s.t(a.f.x,a.f.y);d.w&&(m.x+=h.x*d.w.x,m.y+=h.y*d.w.y);a.w&&(e.x+=g.x*a.w.x,e.y+=g.y*a.w.y);h=d.wa?Infinity:d.W;g=a.wa?Infinity:a.W;var t=d.fixed?Infinity:d.Aa(),u=a.fixed?Infinity:a.Aa();m=d.sa*a.sa*2*(e.za(c).v-m.za(c).v+
a.A*s.z-d.A*q.z)/(1/g+1/h+s.z*s.z/u+q.z*q.z/t);d.f.x+=m/h*c.v.x;d.f.y+=m/h*c.v.y;a.f.x-=m/g*c.v.x;a.f.y-=m/g*c.v.y;d.A+=m*r/t;a.A-=m*b/u}function a(d,a){var b,c,e,p,h,r,g;p=d.ya();h=a.ya();b=Math.max(p.G,h.G)-1;c=Math.min(p.ea,h.ea)+1;e=Math.max(p.D,h.D)-1;p=Math.min(p.X,h.X)+1;if(!(0>=c-b||0>=p-e)){b=d.k.getImageData(0,0,d.g,d.q);d.k.scale(1/(d.h||1),1/(d.p||1));d.k.rotate(-(d.l||0));d.k.translate(a.i*d.b.d-d.i*d.b.d,a.j*d.b.d-d.j*d.b.d);d.k.rotate(a.l||0);d.k.scale(a.h||1,a.p||1);d.k.globalCompositeOperation=
"destination-out";d.k.drawImage(a.O.canvas,0,0,a.g,a.q,a.G,a.D,a.g,a.q);d.k.scale(1/(a.h||1),1/(a.p||1));d.k.rotate(-a.l||0);d.k.translate(-a.i*d.b.d+d.i*d.b.d,-a.j*d.b.d+d.j*d.b.d);d.k.rotate(d.l||0);d.k.scale(d.h||1,d.p||1);r=d.k.getImageData(0,0,d.g,d.q);d.k.globalCompositeOperation="source-over";d.k.putImageData(b,0,0);g=[];d.ua.forEach(function(a){90>r.data[a.y*d.g*4+4*a.x+3]&&g.push(a)});if(2>g.length)return null;var q;e=c=0;b=g.length-1;for(p=1;p<g.length;p++)for(h=p+1;h<g.length;h++){q=g[p].x-
g[h].x;var s=g[p].y-g[h].y;q=Math.sqrt(q*q+s*s);q>c&&(c=q,e=p,b=h)}c=d.aa(g[e].x+d.left,g[e].y+d.D);b=d.aa(g[b].x+d.left,g[b].y+d.D);return c.x==b.x&&c.y==b.y?null:{x:(c.x+b.x)/2,y:(c.y+b.y)/2,eb:f.s.Ta(c.x,c.y,b.x,b.y)}}}this.bb=function(d){var b=e(),l,n,m=null;l=d.xa();b=b.filter(function(a){var b;if(a.$===d.$||!(a.f.x||a.f.y||d.f.x||d.f.y||a.w||d.w||d.A||a.A))return!1;b=a.xa();return Math.sqrt((l.x-b.x)*(l.x-b.x)+(l.y-b.y)*(l.y-b.y))>d.Ba()+a.Ba()?!1:!0});if(0==b.length)return!0;n=null;b.forEach(function(b){n||
(n=a(d,b))&&(m=b)});if(!n)return!0;c(d,m,n);d.m.r("collision").I({element:m,Oa:n});m.m.r("collision").I({element:d,Oa:n});return!1}};(function(){function b(a){this.o.translate(a.i*this.d,a.j*this.d);this.o.rotate(a.l||0);this.o.scale(a.h||1,a.p||1);this.o.drawImage(a.L.canvas,0,0,a.g,a.q,a.G,a.D,a.g,a.q);this.o.scale(1/(a.h||1),1/a.p||1);this.o.rotate(-(a.l||0));this.o.translate(-a.i*this.d,-a.j*this.d)}function e(){var a=this;setInterval(function(){a.Ea&&!a.la&&(a.la=!0,a.elements.sort(function(a,d){return(a.Q||0)-(d.Q||0)}).forEach(function(c){b.call(a,c)}),a.la=!1)},a.ab)}function c(d,b){var c=this;c.add(["name","background"],
["image",{left:0,top:0,width:c.o.canvas.width/c.d,height:c.o.canvas.height/c.d,draw:d||function(d){d.fillStyle=b||a.n.La;d.fillRect(0,0,c.o.canvas.width/c.d,c.o.canvas.height/c.d)}}],["position",{z:-Infinity}])}var a=f.a;a.n=function(d){var b=d.canvas;this.Da=d.log;this.d=d.lengthScale||b.height/d.realHeight||b.width/d.realWidth||1;timeScale=d.timeScale||1;var l=0;setInterval(function(){l+=10*timeScale/1E3},10);this.getTime=function(){return l};this.Ea=!0;this.la=!1;this.ab=d["controller.refreshTime"]||
a.n.Ma;this.elements=[];this.m=new f.T.ga;this.o=b.getContext("2d");this.o.setTransform(1,0,0,1,0,0);this.ma("click","click");this.ma("mousedown","pointerDown");this.ma("touchstart","pointerDown");this.da("mousemove","pointerMove");this.da("touchmove","pointerMove");this.da("mouseup","pointerUp");this.da("touchend","pointerUp");c.call(this,d.drawBackground,d.backgroundStyle);e.call(this)};a.n.prototype.Ca=function(a){this.Da&&this.Da(a)};a.n.prototype.oa=function(a,b){var c=!1;this.elements.filter(function(b){return b.Na(a)}).sort(function(a,
b){return b.Q||0-a.Q||0}).forEach(function(e){!c&&e.Wa(b.x,b.y)&&(e.m.r(a).I(b),c=!0)})};a.n.prototype.Ha=function(a,b){this.elements.forEach(function(c){c.u==b.u&&c.m.r(a).I(b)})};a.n.prototype.ma=function(a,b){var c=this;c.o.canvas.addEventListener(a,function(a){setTimeout(function(){if(a.changedTouches)for(var d=0;d<a.changedTouches.length;d++){var e=a.changedTouches[d].identifier,h=c.ba(a.changedTouches[d]);h.u=e;c.oa(b,h)}else d=c.ba(a),d.u=-1,c.oa(b,d)})})};a.n.prototype.da=function(a,b){var c=
this;this.o.canvas.addEventListener(a,function(a){setTimeout(function(){if(a.changedTouches)for(var d=0;d<a.changedTouches.length;d++){var e=a.changedTouches[d].identifier,h=c.ba(a.changedTouches[d]);h.u=e;c.Ha(b,h)}else d=c.ba(a),d.u=-1,c.Ha(b,d)})})};a.n.prototype.cb=function(){this.m.r("deactivate").I();this.elements=[]};a.n.prototype.F=function(){this.Ea=!0};a.n.prototype.ba=function(a){var b=this.o.canvas.getBoundingClientRect();return{x:(a.clientX-b.left)*this.o.canvas.width/b.width/this.d,
y:(a.clientY-b.top)*this.o.canvas.height/b.height/this.d}};a.n.prototype.add=function(){var a=[].slice.call(arguments),b=a.filter(function(a){return a&&"name"==a[0]})[0]||["name","Unknown"],c=a.filter(function(a){return a&&"image"==a[0]})[0],e=a.filter(function(a){return a&&"position"==a[0]})[0],b=new f.a.c(this,b,c,e);b.$=0==this.elements.length?0:this.elements[this.elements.length-1].$+1;a=a.filter(function(a){return a&&"name"!=a[0]&&"position"!=a[0]&&"image"!=a[0]});0<a.length&&f.a.e&&b.qa.apply(b,
a);this.elements.push(b);return b};a.n.Ma=50;a.n.La="#FFF";a.Controller=a.n;a.n.prototype.addElement=a.n.prototype.add;a.n.prototype.redraw=a.n.prototype.F;a.n.prototype.stop=a.n.prototype.cb})();(function(){function b(a,b){a.i=b.x||0;a.j=b.y||0;a.Q=b.z||0;a.l=b.angle||0}function e(a,b){var c=b.width,e=b.height;a.top=0==b.top?0:b.top||-e/2;a.left=0==b.left?0:b.left||-c/2;a.bottom=0==b.bottom?0:b.bottom||a.top+e;a.right=0==b.right?0:b.right||a.left+c;a.K=c||a.right-a.left;a.P=e||a.bottom-a.top;a.D=Math.round(a.top*a.b.d);a.G=Math.round(a.left*a.b.d);a.X=Math.round(a.bottom*a.b.d);a.ea=Math.round(a.right*a.b.d);a.g=Math.round(a.K*a.b.d);a.q=Math.round(a.P*a.b.d);c=a.b.o.canvas.ownerDocument.createElement("canvas");
a.L=c.getContext("2d");a.h=b.scaleX||1;a.p=b.scaleY||1;b.rawImage?(a.V=b.rawImage,a.L.putImageData(a.V,0,0)):(e=b.draw,c.width=a.g,c.height=a.q,a.L.beginPath(),a.L.translate(-a.G,-a.D),a.L.scale(a.b.d,a.b.d),e.call(a,a.L),a.V=a.L.getImageData(0,0,a.g,a.q))}var c=f.a;c.c=function(a,c,k,l){var n=this;this.b=a;this.Y=[];this.N=[];this.m=this.m||new f.T.ga;n.ja=c[1];e(n,k[1]);b(n,l[1]);this.N.push(c);this.N.push(k);this.N.push(l);n.b.m.r("deactivate").addListener(function(){n.Pa()})};c.c.prototype.Wa=
function(a,b){var c=this.Sa(a,b),e=c.x-this.G,c=c.y-this.D;return 0<=e&&e<=this.g&&0<=c&&c<=this.q&&0<this.V.data[4*c*this.g+4*e+3]};c.c.prototype.ia=function(a,b){var c=f.a.e[a];c&&(this.N.push([a,b]),c.H(this,b))};c.c.prototype.ka=function(a,b,c){if(this.Y[a]&&this.Y[a].key==b)return this.Y[a].value;c=c.call(this);this.Y[a]={key:b,value:c};return c};c.c.prototype.ra=function(a){var b=a?this.N.filter(function(b){return a.every(function(a){return a!=b[0]})}):this.N;return this.b.add.apply(this.b,
b)};c.c.prototype.Na=function(a){return"click"==a||"pointerDown"==a||this.m.Va(a)};c.c.prototype.Pa=function(){this.L=null};c.c.prototype.F=function(){this.b.F()};c.c.prototype.aa=function(a,b){return{x:this.i+(a*this.h*Math.cos(this.l)-b*this.p*Math.sin(this.l))/this.b.d,y:this.j+(a*this.h*Math.sin(this.l)+b*this.p*Math.cos(this.l))/this.b.d}};c.c.prototype.Sa=function(a,b){return{x:Math.round(((a-this.i)*this.b.d*Math.cos(this.l)+(b-this.j)*this.b.d*Math.sin(this.l))/this.h),y:Math.round(((b-this.j)*
this.b.d*Math.cos(this.l)-(a-this.i)*this.b.d*Math.sin(this.l))/this.p)}};c.c.prototype.xa=function(){return this.aa(this.G+this.g/2,this.D+this.q/2)};c.c.prototype.Ra=function(){var a=this;return this.ka("getClientCorners",a.i+""+a.j+""+a.l+""+a.h+""+a.h,function(){var b=[];b.push({x:a.G,y:a.D});b.push({x:a.ea,y:a.D});b.push({x:a.ea,y:a.X});b.push({x:a.G,y:a.X});return b.map(function(b){return a.aa(b.x,b.y)})})};c.c.prototype.ya=function(){var a=this;return this.ka("getClientRect",a.i+""+a.j+""+
a.l+""+a.h+""+a.h,function(){var b=a.Ra();return{top:b.reduce(function(a,b){return Math.min(a,b.y)},Infinity),bottom:b.reduce(function(a,b){return Math.max(a,b.y)},-Infinity),left:b.reduce(function(a,b){return Math.min(a,b.x)},Infinity),right:b.reduce(function(a,b){return Math.max(a,b.x)},-Infinity)}})};c.c.prototype.qa=function(){var a=this;[].slice.apply(arguments).forEach(function(b){a.ia(b[0],b[1])})};c.c.prototype.clone=c.c.prototype.ra;c.c.prototype.applyDecorator=c.c.prototype.ia;c.c.prototype.applyDecorators=
c.c.prototype.qa;Object.defineProperty(c.c.prototype,"width",{get:function(){return this.K},set:function(a){this.K=a}});Object.defineProperty(c.c.prototype,"height",{get:function(){return this.P},set:function(a){this.P=a}});Object.defineProperty(c.c.prototype,"scaleX",{get:function(){return this.h},set:function(a){this.h=a}});Object.defineProperty(c.c.prototype,"scaleY",{get:function(){return this.p},set:function(a){this.p=a}});Object.defineProperty(c.c.prototype,"x",{get:function(){return this.i},
set:function(a){this.i=a}});Object.defineProperty(c.c.prototype,"y",{get:function(){return this.j},set:function(a){this.j=a}});Object.defineProperty(c.c.prototype,"z",{get:function(){return this.Q},set:function(a){this.Q=a}});Object.defineProperty(c.c.prototype,"angle",{get:function(){return this.l},set:function(a){this.l=a}});Object.defineProperty(c.c.prototype,"name",{get:function(){return this.ja}});Object.defineProperty(c.c.prototype,"id",{get:function(){return this.$}});Object.defineProperty(c.c.prototype,
"image",{get:function(){return this.V}});Object.defineProperty(c.c.prototype,"events",{get:function(){return this.m}})})();f=f||{};f.a=f.a||{};f.a.e=f.a.e||[];f.a.e.clickable={H:function(b,e){var c=!1,a=e.ondown,d=e.onup,k=e.onclick;this.u=null;k&&b.m.r("click").addListener(function(a){k.call(b,a);b.F()});a&&b.m.r("pointerDown").addListener(function(d){b.u=d.u;c=!0;a.call(b,event);b.F()});d&&b.m.r("pointerUp").addListener(function(a){c&&b.u==a.u&&(c=!1,d.call(b,event),b.F())})}};f=f||{};f.a=f.a||{};f.a.e=f.a.e||[];f.a.e.customTimer={H:function(b,e){setInterval(function(){e.action.call(b)},e.time)}};f=f||{};f.a=f.a||{};f.a.e=f.a.e||[];f.a.e.droppable={H:function(b,e){b.Ya=!0;b.va=e.dropZone;Object.defineProperty(b,"dropZone",{get:function(){return this.va},set:function(b){this.va=b}})}};f=f||{};f.a=f.a||{};f.a.e=f.a.e||[];f.a.e.dropzone={H:function(b,e){var c=e.availableSpots,a=e.dropX,d=e.dropY;b.Z=[];b.m.r("drop").addListener(function(e){0>=c||(c--,e.J.x=a||b.i,e.J.y=d||b.j,e.J.U=b,b.Z.push(e.J),e.J.m.r("dropped").I({U:b,J:e.J}),b.m.r("droppedIn").I({dropZone:b,droppedElement:e.J}),b.F())});b.Qa=function(a){a.U=null;c++;b.Z.splice(b.Z.indexOf(a),1);b.F()};Object.defineProperty(b,"droppedElements",{get:function(){return b.Z}})}};f=f||{};f.a=f.a||{};f.a.e=f.a.e||[];f.a.e.duplicable={H:function(b,e){var c=e.isBlocked,a=e.generatorCount||Infinity,d=!1;b.m.r("pointerDown").addListener(function(e){0<=e.u&&(d=!0);if(!(d&&0>e.u||c&&c()||0>=a)){a--;var l=b.ra(["duplicable"]);l.ja+=" (duplicate)";l.ia("movable",{Xa:c});l.Ga(e);b.F()}})}};f.a.e=f.a.e||[];f.a.elementDecorators=f.a.e;f=f||{};f.a=f.a||{};f.a.e=f.a.e||[];
f.a.e.movable={H:function(b,e){var c=!1,a=this.u=null,d=e.Xa;b.Ga=function(d){c=!0;b.u=d.u;a={x:d.x,y:d.y};b.U&&(b.U.Qa(b),b.U=null)};b.$a=function(d){c=!1;a=null;b.Ya&&b.b.oa("drop",{x:d.x,y:d.y,J:b})};b.m.r("pointerDown").addListener(function(a){d&&d()||b.Ga(a)});var k=!1;b.m.r("pointerMove").addListener(function(e){!c||d&&d()||(k||(k=!0),b.i+=e.x-a.x,b.j+=e.y-a.y,a={x:e.x,y:e.y},b.F())});b.m.r("pointerUp").addListener(function(e){!c||d&&d()||(b.i+=e.x-a.x,b.j+=e.y-a.y,b.$a(e),b.u=null,k=!1,b.F())})}};f=f||{};f.a=f.a||{};f.a.e=f.a.e||[];
f.a.e.moving={type:"moving",H:function(b,e){var c,a,d,k,l,n=e.ax,m=e.ay,p=e.rotationSpeed,h,r,g;b.f=new f.s.t(e.vx||0,e.vy||0);b.R=new f.s.t(n||0,m||0);b.A=p||0;h=b.b.getTime();setInterval(function(){r=b.b.getTime();g=r-h;if(!(.001>g)&&(h=r,b.f.x+=b.R.x*g,b.f.y+=b.R.y*g,0!=b.f.x||0!=b.f.y||0!=b.A||b.w&&(0!=b.w.x||0!=b.w.y))){c=b.i;a=b.j;d=b.l;k=b.h;l=b.p;b.i+=b.f.x*g;b.j+=b.f.y*g;b.l+=b.A*g;b.w&&(b.h+=b.w.x*g,b.p+=b.w.y*g);var e=!0;b.ca&&b.ca.forEach(function(a){e&&(a.call(b)||(e=!1))});e||(b.i=c,
b.j=a,b.l=d,b.h=k,b.p=l)}},20);Object.defineProperty(b,"speed",{get:function(){return this.f},set:function(a){this.f=a}});Object.defineProperty(b,"acceleration",{get:function(){return this.R},set:function(a){this.R=a}});Object.defineProperty(b,"rotationSpeed",{get:function(){return this.A},set:function(a){this.A=a}});Object.defineProperty(b,"scaleSpeed",{get:function(){return this.w},set:function(a){this.w=a}})}};f=f||{};
(function(){function b(){var b=this.b.o.canvas.ownerDocument.createElement("canvas");b.width=this.g;b.height=this.q;this.k=b.getContext("2d");this.k.globalCompositeOperation="source-over";this.k.drawImage(this.O.canvas,0,0);var b=this.k.getImageData(0,0,this.g,this.q),a=this.k.createImageData(this.g,this.q);this.ua=[];for(var d=0;d<this.g;d++)for(var e=0;e<this.q;e++)if(!(200>b.data[e*this.g*4+4*d+3])){for(var l=!1,n=-1;2>n;n++)for(var m=-1;2>m;m++)if(0>e+n||0>d+m||e+n>this.q-1||d+n>this.K-1||100>
b.data[(e+n)*this.K*4+4*(d+m)+3])l=!0,m=n=2;this.k.putImageData(a,0,0);l&&(this.ua.push({x:d,y:e}),a.data[e*this.g*4+4*d]=0,a.data[e*this.g*4+4*d+1]=0,a.data[e*this.g*4+4*d+2]=0,a.data[e*this.g*4+4*d+3]=255)}this.k.putImageData(a,0,0);this.k.translate(-this.G,-this.D)}function e(){var b=this.b.o.canvas.ownerDocument.createElement("canvas");b.width=this.g;b.height=this.q;this.O=b.getContext("2d");this.O.putImageData(this.V,0,0);this.O.globalCompositeOperation="source-atop";this.O.fillStyle="#000";
this.O.fillRect(0,0,this.g,this.q)}f.a=f.a||{};f.a.e=f.a.e||[];f.a.e.solid={H:function(c,a){c.Za=!0;c.W=a.mass||1;var d=a.onCollision,k=a.coefficient;c.fixed=a.fixed||!1;c.wa=c.fixed||a.fixedPoint||!1;c.b.ta=c.b.ta||new f.a.Ja(c.b);c.sa=k||0===k?k:1;c.f=c.f||new f.s.t(0,0);c.R=c.R||new f.s.t(0,0);c.A=c.A||0;c.m.r("collision").addListener(function(a){d&&d.call(c,a)});c.ca=this.ca||[];c.ca.push(function(){return c.b.ta.bb(c)});e.call(c);b.call(c);c.Aa=function(){return c.W/12*(c.g*c.h*c.g*c.h+c.q*c.p*
c.q*c.p)};c.Ba=function(){return this.ka("getRadius",c.K+""+c.P+""+c.h+""+c.p,function(){return Math.sqrt(this.K*this.K*this.h*this.h+this.P*this.P*this.p*this.p)/2})};Object.defineProperty(c,"mass",{get:function(){return this.W},set:function(a){this.W=a}})}}})();(function(){var b=f.T=f.T||{};b.pa=function(){var b=0,c=[];this.I=function(a,b){var e=c.length;c.forEach(function(c){setTimeout(function(){c.handleEvent(a);e--;0==e&&b&&b()})})};this.addListener=function(a,d){var k=b++;c.push({Ua:k,handleEvent:a,Fa:d});c=c.sort(function(a,b){return(a.Fa||Infinity)-(b.Fa||Infinity)});return k};this.removeListener=function(a){c=c.filter(function(b){return b.Ua!=a})};this.addEventListener=this.addListener;this.removeEventListener=this.removeListener;this.dispatch=this.I};
f.Creevents=b;b.Event=b.pa})();(function(){var b=f.T=f.T||{};b.ga=function(){var e={};this.Va=function(b){return void 0!=e[b]};this.getEvent=this.r=function(c){e[c]||(e[c]=new b.pa);return e[c]}};b.EventContainer=b.ga})();(function(){var b=f.Ka=f.Ka||{};b.ha=function(){this.Ca=function(b){console.log(b)}};f.Crelog=b;b.Logger=b.ha;b.ha.log=b.ha.Ca})();
